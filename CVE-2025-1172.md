### Vulnerability Details:

The `addtocart.php` in the Bookstore Management System from 1000 Projects is vulnerable to SQL injection.

Project URL/Address：[https://1000projects.org/bookstore-management-system-php-mysql-project.html](https://1000projects.org/bookstore-management-system-php-mysql-project.html)
### Vulnerability Reproduction:

The `bcid` parameter is not properly filtered and is directly concatenated into the SQL query, leading to a SQL injection vulnerability.
![[Pasted image 20250211102647.png]]
Log in using the account:  
`dhaval/dhaval123`
![[Pasted image 20250211102726.png]]
Click on any book to add it, and capture the `addtocart` API request.
![[Pasted image 20250211102741.png]]
Copy the request payload to a text file.  
Payload:  
`AND (SELECT 9017 FROM (SELECT(SLEEP(5)))hBgM)`
![[Pasted image 20250211102754.png]]
Successfully retrieved all database names.

### Fix Recommendation:

Use prepared statements for SQL queries to prevent SQL injection.
